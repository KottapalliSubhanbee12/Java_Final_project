const users = {
    "9063163226": { code: "1234", balance: 5000, history: ["Bought Book - â‚¹500", "ATM Withdrawal - â‚¹1000"] }
};

function login() {
    const card = document.getElementById("loginCard").value;
    const code = document.getElementById("loginCode").value;

    if (users[card] && users[card].code === code) {
        sessionStorage.setItem("cardNumber", card);
        document.getElementById("loginSection").style.display = "none";
        document.getElementById("machineSection").style.display = "block";
        document.getElementById("exitBtn").style.display = "inline-block";
        document.getElementById("cardNumber").value = card;
        document.getElementById("secretCode").value = code;
    } else {
        alert("Invalid credentials!");
    }
}

function registerCard() {
    const newCard = document.getElementById("newCard").value;
    const newCode = document.getElementById("newCode").value;

    if (newCard && newCode) {
        users[newCard] = { code: newCode, balance: 0, history: [] };
        alert("Card registered successfully!");
    } else {
        alert("Please enter both card number and code!");
    }
}

function swipeCard() {
    const card = document.getElementById("cardNumber").value;
    const code = document.getElementById("secretCode").value;
    const amount = parseInt(document.getElementById("amount").value);

    if (users[card] && users[card].code === code) {
        if (amount > 0 && users[card].balance >= amount) {
            users[card].balance -= amount;
            const time = new Date().toLocaleString();
            users[card].history.push(`Swiped â‚¹${amount} on ${time}`);
            document.getElementById("message").innerText = `Transaction Successful!`;
            document.getElementById("receipt").innerText =
                `--- RECEIPT ---\nCard No: ${card}\nAmount: â‚¹${amount}\nTime: ${time}\n-----------------`;
        } else {
            document.getElementById("message").innerText = "Insufficient balance or invalid amount!";
        }
    } else {
        document.getElementById("message").innerText = "Invalid card or code.";
    }
}

function checkBalance() {
    const card = document.getElementById("cardNumber").value;
    const code = document.getElementById("secretCode").value;
    if (users[card] && users[card].code === code) {
        document.getElementById("message").innerText = "Balance: â‚¹" + users[card].balance;
    } else {
        document.getElementById("message").innerText = "Invalid card or code.";
    }
}

function viewHistory() {
    const card = document.getElementById("cardNumber").value;
    const code = document.getElementById("secretCode").value;
    if (users[card] && users[card].code === code) {
        document.getElementById("message").innerText = "History: " + users[card].history.join(", ");
    } else {
        document.getElementById("message").innerText = "Invalid card or code.";
    }
}

function exitApp() {
    sessionStorage.clear();
    document.getElementById("machineSection").style.display = "none";
    document.getElementById("loginSection").style.display = "block";
    document.getElementById("exitBtn").style.display = "none";
}

// Language Support
const translations = {
    en: {
        loginTitle: "Login",
        cardPlaceholder: "Enter Card Number",
        codePlaceholder: "Enter Secret Code",
        loginBtn: "Login",
        registerTitle: "New Card? Register Below",
        newCardPlaceholder: "New Card Number",
        newCodePlaceholder: "New Secret Code",
        registerBtn: "Register",
        swipeTitle: "Swipe Your Card",
        amountPlaceholder: "Enter Amount to Swipe",
        swipeBtn: "ðŸ’³ Swipe",
        balanceBtn: "ðŸ’° Balance",
        historyBtn: "ðŸ“œ History"
    },
    te: {
        loginTitle: "à°ªà±à°°à°µà±‡à°¶à°¿à°‚à°šà°‚à°¡à°¿",
        cardPlaceholder: "à°•à°¾à°°à±à°¡à± à°¨à°‚à°¬à°°à± à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿",
        codePlaceholder: "à°¸à±€à°•à±à°°à±†à°Ÿà± à°•à±‹à°¡à± à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿",
        loginBtn: "à°ªà±à°°à°µà±‡à°¶à°¿à°‚à°šà°‚à°¡à°¿",
        registerTitle: "à°•à±Šà°¤à±à°¤ à°•à°¾à°°à±à°¡à±? à°¨à°®à±‹à°¦à± à°šà±‡à°¯à°‚à°¡à°¿",
        newCardPlaceholder: "à°•à±Šà°¤à±à°¤ à°•à°¾à°°à±à°¡à± à°¨à°‚à°¬à°°à±",
        newCodePlaceholder: "à°•à±Šà°¤à±à°¤ à°¸à±€à°•à±à°°à±†à°Ÿà± à°•à±‹à°¡à±",
        registerBtn: "à°¨à°®à±‹à°¦à±",
        swipeTitle: "à°®à±€ à°•à°¾à°°à±à°¡à±à°¨à± à°¸à±à°µà±ˆà°ªà± à°šà±‡à°¯à°‚à°¡à°¿",
        amountPlaceholder: "à°¸à±à°µà±ˆà°ªà± à°šà±‡à°¯à°¾à°²à±à°¸à°¿à°¨ à°®à±Šà°¤à±à°¤à°‚",
        swipeBtn: "ðŸ’³ à°¸à±à°µà±ˆà°ªà±",
        balanceBtn: "ðŸ’° à°¬à±à°¯à°¾à°²à±†à°¨à±à°¸à±",
        historyBtn: "ðŸ“œ à°šà°°à°¿à°¤à±à°°"
    },
    kn: {
        loginTitle: "à²²à²¾à²—à²¿à²¨à³ à²®à²¾à²¡à²¿",
        cardPlaceholder: "à²•à²¾à²°à³à²¡à³ à²¸à²‚à²–à³à²¯à³† à²¨à²®à³‚à²¦à²¿à²¸à²¿",
        codePlaceholder: "à²¸à³€à²•à³à²°à³†à²Ÿà³ à²•à³‹à²¡à³ à²¨à²®à³‚à²¦à²¿à²¸à²¿",
        loginBtn: "à²²à²¾à²—à²¿à²¨à³",
        registerTitle: "à²¹à³Šà²¸ à²•à²¾à²°à³à²¡à³? à²¨à³‹à²‚à²¦à²¾à²¯à²¿à²¸à²¿",
        newCardPlaceholder: "à²¹à³Šà²¸ à²•à²¾à²°à³à²¡à³ à²¸à²‚à²–à³à²¯à³†",
        newCodePlaceholder: "à²¹à³Šà²¸ à²¸à³€à²•à³à²°à³†à²Ÿà³ à²•à³‹à²¡à³",
        registerBtn: "à²¨à³‹à²‚à²¦à²¾à²¯à²¿à²¸à²¿",
        swipeTitle: "à²¨à²¿à²®à³à²® à²•à²¾à²°à³à²¡à³ à²¸à³à²µà³ˆà²ªà³ à²®à²¾à²¡à²¿",
        amountPlaceholder: "à²¸à³à²µà³ˆà²ªà³ à²®à²¾à²¡à³à²µ à²®à³Šà²¤à³à²¤",
        swipeBtn: "ðŸ’³ à²¸à³à²µà³ˆà²ªà³",
        balanceBtn: "ðŸ’° à²¶à³†à²·",
        historyBtn: "ðŸ“œ à²‡à²¤à²¿à²¹à²¾à²¸"
    },
    ml: {
        loginTitle: "à´²àµ‹à´—à´¿àµ»",
        cardPlaceholder: "à´•à´¾àµ¼à´¡àµ à´¨à´®àµà´ªàµ¼ à´¨àµ½à´•àµà´•",
        codePlaceholder: "à´±à´¹à´¸àµà´¯ à´•àµ‹à´¡àµ à´¨àµ½à´•àµà´•",
        loginBtn: "à´²àµ‹à´—à´¿àµ»",
        registerTitle: "à´ªàµà´¤à´¿à´¯ à´•à´¾àµ¼à´¡àµ? à´°à´œà´¿à´¸àµà´±àµà´±àµ¼ à´šàµ†à´¯àµà´¯àµà´•",
        newCardPlaceholder: "à´ªàµà´¤à´¿à´¯ à´•à´¾àµ¼à´¡àµ à´¨à´®àµà´ªàµ¼",
        newCodePlaceholder: "à´ªàµà´¤à´¿à´¯ à´°à´¹à´¸àµà´¯ à´•àµ‹à´¡àµ",
        registerBtn: "à´°à´œà´¿à´¸àµà´±àµà´±àµ¼",
        swipeTitle: "à´¨à´¿à´™àµà´™à´³àµà´Ÿàµ† à´•à´¾àµ¼à´¡àµ à´¸àµà´µàµˆà´ªàµà´ªàµ à´šàµ†à´¯àµà´¯àµà´•",
        amountPlaceholder: "à´¤àµà´• à´¨àµ½à´•àµà´•",
        swipeBtn: "ðŸ’³ à´¸àµà´µàµˆà´ªàµà´ªàµ",
        balanceBtn: "ðŸ’° à´¬à´¾à´²àµ»à´¸àµ",
        historyBtn: "ðŸ“œ à´šà´°à´¿à´¤àµà´°à´‚"
    },
    ta: {
        loginTitle: "à®‰à®³à¯à®¨à¯à®´à¯ˆà®¯",
        cardPlaceholder: "à®…à®Ÿà¯à®Ÿà¯ˆ à®Žà®£à¯à®£à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯",
        codePlaceholder: "à®°à®•à®šà®¿à®¯ à®•à¯à®±à®¿à®¯à¯€à®Ÿà¯à®Ÿà¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯",
        loginBtn: "à®‰à®³à¯à®¨à¯à®´à¯ˆà®¯",
        registerTitle: "à®ªà¯à®¤à®¿à®¯ à®…à®Ÿà¯à®Ÿà¯ˆ? à®ªà®¤à®¿à®µà¯ à®šà¯†à®¯à¯à®¯à®µà¯à®®à¯",
        newCardPlaceholder: "à®ªà¯à®¤à®¿à®¯ à®…à®Ÿà¯à®Ÿà¯ˆ à®Žà®£à¯",
        newCodePlaceholder: "à®ªà¯à®¤à®¿à®¯ à®°à®•à®šà®¿à®¯ à®•à¯à®±à®¿à®¯à¯€à®Ÿà¯",
        registerBtn: "à®ªà®¤à®¿à®µà¯",
        swipeTitle: "à®‰à®™à¯à®•à®³à¯ à®•à®¾à®°à¯à®Ÿà¯ˆà®ªà¯ à®šà¯Šà®Ÿà¯à®•à¯à®•à®µà¯à®®à¯",
        amountPlaceholder: "à®¤à¯Šà®•à¯ˆà®¯à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯",
        swipeBtn: "ðŸ’³ à®¸à¯à®µà¯ˆà®ªà¯",
        balanceBtn: "ðŸ’° à®‡à®°à¯à®ªà¯à®ªà¯",
        historyBtn: "ðŸ“œ à®µà®°à®²à®¾à®±à¯"
    }
};

function setLanguage(lang) {
    const text = translations[lang];
    document.querySelectorAll("[data-key]").forEach(el => {
        const key = el.getAttribute("data-key");
        if (text[key]) el.innerText = text[key];
    });
    document.querySelectorAll("[data-key-placeholder]").forEach(el => {
        const key = el.getAttribute("data-key-placeholder");
        if (text[key]) el.placeholder = text[key];
    });
}
